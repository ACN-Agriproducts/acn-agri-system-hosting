<ion-card *ngIf="itemForm">
  <ion-card-header>
    <span [class.attention]="item.needsAttention">Item {{index + 1}}</span>
  </ion-card-header>
  <ion-card-content>
    <form [formGroup]="itemForm">
      <ion-item>
        <ion-grid>
          <ion-row>
            <ion-col size="6">
              <mat-form-field>
                <mat-label>Item Name</mat-label>
                <input matInput formControlName="name">
              </mat-form-field>
            </ion-col>
            <ion-col size="2">
              <mat-form-field>
                <mat-label>Quantity</mat-label>
                <input matInput formControlName="quantity" type="number" step="1">
              </mat-form-field>
            </ion-col>
            <ion-col size="2">
              <mat-form-field>
              <mat-label>Price</mat-label>
              <div matPrefix>$</div>
              <input matInput formControlName="price" type="number" step="0.01">
              </mat-form-field>
            </ion-col>
            <ion-col size="2">
              <mat-checkbox formControlName="affectsInventory">Inv.</mat-checkbox>
            </ion-col>
          </ion-row>
          <div formArrayName="inventoryInfo">
            <ion-row *ngFor="let info of itemForm.get('inventoryInfo')['controls']; let i = index" [hidden]="!itemForm.value.affectsInventory" [formGroupName]="i">
              <ion-col size="1">
                <button mat-icon-button color='warn' (click)="deleteInfo(i)">
                  <mat-icon>delete</mat-icon>
                </button>
              </ion-col>
              <ion-col size="3">
                <mat-form-field>
                  <mat-label>Product</mat-label>
                  <mat-select formControlName="product">
                    <mat-option *ngFor="let product of productList" value={{product.id}}>{{product.id}}</mat-option>
                  </mat-select>
                </mat-form-field>
              </ion-col>
              <ion-col size="2">
                <mat-form-field>
                  <mat-label>Quantity</mat-label>
                  <input matInput type="number" formControlName="quantity">
                  <div matSuffix>lbs</div>
                </mat-form-field>
              </ion-col>
              <ion-col size="3">
                <mat-form-field>
                  <mat-label>Plant</mat-label>
                  <mat-select formControlName="plant">
                    <mat-option *ngFor="let plant of plantsList" value="{{plant.id}}" >{{plant.id | titlecase}}</mat-option>
                  </mat-select>
                </mat-form-field>
              </ion-col>
              <ion-col size="3">
                <mat-form-field>
                  <mat-label>Storage</mat-label>
                  <mat-select formControlName="tank" *ngIf="storageList">
                    <mat-option *ngFor="let tank of storageList[getInfo(i).plant]" value="{{tank.name}}">{{tank.name}}</mat-option>
                    <mat-option value="none">None</mat-option>
                  </mat-select>
                </mat-form-field>
              </ion-col>
            </ion-row>
          </div>
        </ion-grid>
      </ion-item>
      <ion-item lines="none">
        <button mat-button color="primary" (click)="addInvButton()">+ Add Inv...</button>
        <button mat-button color="primary" (click)="submitButton()">Submit</button>
      </ion-item>
    </form>
  </ion-card-content>
</ion-card>