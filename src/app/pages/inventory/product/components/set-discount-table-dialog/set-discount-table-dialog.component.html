
<h2 mat-dialog-title>New Discount Table</h2>

<mat-dialog-content>
    <form #tableForm="ngForm">
        <div class="form-field-group">
            <mat-form-field appearance="fill">
                <mat-label>Field Name</mat-label>
                <mat-select [(ngModel)]="table.fieldName" (selectionChange)="setName($event.value)" name="fieldName" required>
                    <mat-option *ngFor="let discountField of discountFieldsList" [value]="discountField">{{ discountField }}</mat-option>
                </mat-select>
                <mat-error>Field Required</mat-error>
            </mat-form-field>
            <mat-form-field appearance="fill">
                <mat-label>Name</mat-label>
                <input matInput [(ngModel)]="table.name" type="text" name="name" required>
                <mat-error>Field Required</mat-error>
            </mat-form-field>
        </div>
        <mat-form-field appearance="fill">
            <mat-label>{{ standardConfig ? "Additional Headers" : "Headers" }}</mat-label>
            <mat-chip-list #chipList
                class="mat-chip-list-stacked"
                cdkDropList
                cdkDropListOrientation="vertical"
                (cdkDropListDropped)="drop($event)"
                multiple
            >
                <mat-chip
                    cdkDrag
                    *ngFor="let header of table.headers"
                    (removed)="remove(header)"
                    selected
                >
                    {{ header }}
                    <button matChipRemove>
                        <mat-icon>cancel</mat-icon>
                    </button>
                </mat-chip>
            </mat-chip-list>
            <input placeholder="New header..."
                [matChipInputFor]="chipList"
                [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                [matChipInputAddOnBlur]="true"
                (matChipInputTokenEnd)="add($event)"
            >
        </mat-form-field>

        <section *ngIf="!editing">
            <mat-divider></mat-divider>
            <mat-checkbox 
                class="default-layout-checkbox" 
                [(ngModel)]="standardConfig" 
                name="standardConfig"
            >
                Standard Discount Configuration
            </mat-checkbox>
            <div class="form-field-group" *ngIf="standardConfig">
                <mat-form-field appearance="fill">
                    <mat-label>Min</mat-label>
                    <input matInput [(ngModel)]="min" type="number" name="min" required>
                    <mat-error>Required</mat-error>
                </mat-form-field>
                <mat-form-field appearance="fill">
                    <mat-label>Max</mat-label>
                    <input matInput [(ngModel)]="max" type="number" name="max" required>
                    <mat-error>Required</mat-error>
                </mat-form-field>
                <mat-form-field appearance="fill" style="grid-column: span 2">
                    <mat-label>Step</mat-label>
                    <input matInput [(ngModel)]="step" type="number" name="step" required>
                    <mat-error>Required</mat-error>
                </mat-form-field>
                <mat-form-field appearance="fill">
                    <mat-label>Discount Start</mat-label>
                    <input matInput [(ngModel)]="discountStart" type="number" name="discount" required>
                    <mat-error>Required</mat-error>
                </mat-form-field>
                <mat-form-field appearance="fill">
                    <mat-label>Discount Step</mat-label>
                    <input matInput [(ngModel)]="discountStep" type="number" name="discountStep">
                    <mat-error>Required</mat-error>
                </mat-form-field>
            </div>
        </section>
    </form>
</mat-dialog-content>

<mat-dialog-actions>
    <button mat-flat-button color="primary" mat-dialog-close>Cancel</button>
    <button mat-flat-button color="primary" [mat-dialog-close]="table" [disabled]="tableForm.invalid" (click)="generateDiscountData()">{{ editing ? "Update" : "Generate"}}</button>
</mat-dialog-actions>
