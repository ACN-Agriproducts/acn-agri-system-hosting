<app-header-toolbar titulo="{{currentContract.type | titlecase}} Contract {{currentContract?.id}}" *ngIf="ready"></app-header-toolbar>
<mat-toolbar>
  <mat-checkbox [(ngModel)]="showLiquidation">Liquidation</mat-checkbox>
</mat-toolbar>

<ion-content *ngIf="!showLiquidation">
  <ion-grid *ngIf="ready">

    <div class="flex-row">        
      <app-contract-form class="form info-card"
        *ngIf="currentContract"
        [contract]="currentContract">
      </app-contract-form>

      <ion-card id="printable-card">
        <ion-card-header>
          Contract Document
        </ion-card-header>
          <app-display-contract [contract]="currentContract"></app-display-contract>
      </ion-card>
    </div>

    <ion-row>
      <ion-col size="6">
        <ion-card>
          <ion-card-header>
            Ticket List
          </ion-card-header>
          <ion-card-content>
            <app-tickets-table #ticketTable *ngIf="ticketList" [ticketList]="ticketList"></app-tickets-table>
          </ion-card-content>
        </ion-card>
      </ion-col>
      <ion-col size="6">
        <ion-card>
          <ion-card-header>
            Trucker List
          </ion-card-header>
          <ion-card-content>
            <app-truckers-form [contract]="currentContract"></app-truckers-form>
          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>

<ion-content class="ion-padding" *ngIf="showLiquidation">
  <button mat-raised-button (click)="reloadContractTickets()">Reload Tickets</button>

  <app-ticket-discount-table 
    [ticketDiscountList]="ticketDiscountList"
    (selectChange)="handleSelectChange()"
  ></app-ticket-discount-table>

  <button mat-raised-button (click)="selectAllTickets()">
    {{ !allSelected ? 'Select All' : 'Deselect All' }}
  </button>
  <button mat-raised-button 
    [disabled]="selectedTickets?.length === 0" 
    (click)="onDownloadLiquidation()"
  >Download</button>
  <button mat-raised-button
    [disabled]="selectedTickets?.length === 0"
    ngxPrint
    [useExistingCss]="true"
    printSectionId="ContractLiquidationLong"
    [printStyle]="{'@page' : { size: 'letter landscape' }}"
  >Print</button>
  <span *ngIf="selectedTickets?.length !== 0" class="selected-tickets-count">( {{ selectedTickets?.length }} Selected )</span>

  <app-contract-liquidation-long id='ContractLiquidationLong' class="printable"
    *ngIf="ticketDiscountList"
    [ticketList]="selectedTickets"
    [contract]="currentContract"
    [totals]="totals"
  ></app-contract-liquidation-long>
</ion-content>
