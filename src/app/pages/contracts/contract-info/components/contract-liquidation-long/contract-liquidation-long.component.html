
<ng-container *transloco="let t, read: 'contracts.info'">
    <div id='title'>
        <h1>ACN AGRIPRODUCTS LLC</h1>
        <span id='address'>1512 Rancho Toluca Rd Progreso TX 78597</span>
    </div>
    
    
    <div class="client-info">
        <img id='company-logo' src='https://firebasestorage.googleapis.com/v0/b/business-manager-c488c.appspot.com/o/logo%2Fcompanylogoonly.png?alt=media&token=cd8bbf25-c1ae-4880-b883-6cfb8f12f9bb'>
        <div id="contract-details">
            <div id='farmer-name'>FARMER NAME: {{ contract.clientName }}</div>
            <div id='contract-id'>Contract {{ contract.id }}</div>
            <div id='date'>DATE: {{ date | date:'fullDate'}}</div>
        </div>
    </div>
    
    <table id="liquidation-table">
        <colgroup>
            <col class="one-fr"> <!-- INBOUND DATE -->
            <col class="one-fr"> <!-- TICKET # -->
            <col class="one-fr"> <!-- WEIGHT: GROSS -->
            <col class="one-fr"> <!-- WEIGHT: TARE -->
            <col class="one-fr"> <!-- WEIGHT: NET -->
            <col class="one-fr"> <!-- MOISTURE: % -->
            <col class="one-fr"> <!-- MOISTURE: CWT -->
            <col class="one-fr"> <!-- DRYING: % -->
            <col class="one-fr"> <!-- DRYING: CWT -->
            <col class="one-fr"> <!-- DAMAGE: % -->
            <col class="one-fr"> <!-- DAMAGE: CWT -->
            <col class="one-and-half-fr"> <!-- ADJUSTED WEIGHT -->
            <col class="one-fr"> <!-- PRICE -->
            <col class="two-fr"> <!-- TOTAL -->
            <col class="one-fr" *ngIf="totals.priceDiscounts.infested"> <!-- INFESTED -->
            <col class="one-fr" *ngIf="totals.priceDiscounts.musty"> <!-- MUSTY -->
            <col class="one-fr" *ngIf="totals.priceDiscounts.sour"> <!-- SOUR -->
            <col class="one-fr" *ngIf="totals.priceDiscounts.weathered"> <!-- BADLY WEATHERED -->
            <col class="one-fr" *ngIf="totals.priceDiscounts.inspection"> <!-- INSPECTION -->
            <col class="two-fr">  <!-- NET TO PAY -->
        </colgroup>
        <tr>
            <th [lang]="language" rowspan="2">{{ t('Inbound Date') | uppercase }}</th>
            <th [lang]="language" rowspan="2">{{ t('Ticket #') | uppercase }}</th>
            <th [lang]="language" colspan="3">{{ t('Weight (lbs)') | uppercase }}</th>
            <th [lang]="language" colspan="2">{{ t('Moisture') | uppercase }}</th>
            <th [lang]="language" colspan="2">{{ t('Drying') | uppercase }}</th>
            <th [lang]="language" colspan="2">{{ t('Damage') | uppercase }}</th>
            <th [lang]="language" rowspan="2">{{ t('Adjusted Weight (lbs)') | uppercase }}</th>
            <th [lang]="language" rowspan="2">{{ t('Price ($/BU)') | uppercase }}</th>
            <th [lang]="language" rowspan="2" *ngIf="totals.priceDiscounts.infested || totals.priceDiscounts.musty || totals.priceDiscounts.sour || totals.priceDiscounts.weathered || totals.priceDiscounts.inspection">{{ t('Total ($)') | uppercase }}</th>
            <th [lang]="language" rowspan="2" *ngIf="totals.priceDiscounts.infested">{{ t('Infested') | uppercase }}</th>
            <th [lang]="language" rowspan="2" *ngIf="totals.priceDiscounts.musty">{{ t('Musty') | uppercase }}</th>
            <th [lang]="language" rowspan="2" *ngIf="totals.priceDiscounts.sour">{{ t('Sour') | uppercase }}</th>
            <th [lang]="language" rowspan="2" *ngIf="totals.priceDiscounts.weathered">{{ t('Weathered') | uppercase }}</th>
            <th [lang]="language" rowspan="2" *ngIf="totals.priceDiscounts.inspection">{{ t('Inspection') | uppercase }}</th>
            <th [lang]="language" rowspan="2">{{ t('Net to Pay ($)') | uppercase }}</th>
    
        </tr>
        <tr>
            <th>{{ t('Gross') | uppercase }}</th>
            <th>{{ t('Tare') | uppercase }}</th>
            <th>{{ t('Net') | uppercase }}</th>
            <th>{{ t('%') }}</th>
            <th>{{ t('CWT') }}</th>
            <th>{{ t('%') }}</th>
            <th>{{ t('CWT') }}</th>
            <th>{{ t('%') }}</th>
            <th>{{ t('CWT') }}</th>
        </tr>
        <tr *ngFor="let ticket of selectedTickets; even as even">
            <td [class.odd]='!even' [class.even]='even' class='center'>{{ ticket.data.dateIn | date:'shortDate' }}</td>
            <td [class.odd]='!even' [class.even]='even' class='center'>{{ ticket.data.id }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right'>{{ ticket.data.gross | massInUnit }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right'>{{ ticket.data.tare | massInUnit }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right'>{{ ticket.data.net | massInUnit }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right'>{{ ticket.data.moisture ?? 0 | number:'1.1-1' }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right'>{{ ticket.weightDiscounts.moisture | number:'1.0-2' }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right'>{{ ticket.data.dryWeightPercent ?? 0 | number:'1.1-1' }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right'>{{ ticket.weightDiscounts.dryWeightPercent | number:'1.0-2' }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right'>{{ ticket.data.damagedGrain ?? 0 | number:'1.1-1' }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right'>{{ ticket.weightDiscounts.damagedGrain | number:'1.0-2' }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right'>{{ (ticket.data.net | massInUnit) - (ticket.weightDiscounts | discounts) }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right'>{{ (contract.price | pricePerUnit:'bu':contract.quantity) | currency:'USD':'$':'1.4-4' }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right' *ngIf="totals.priceDiscounts.infested || totals.priceDiscounts.musty || totals.priceDiscounts.sour || totals.priceDiscounts.weathered || totals.priceDiscounts.inspection">{{ (contract.price | pricePerUnit:'lbs':contract.quantity) * ((ticket.data.net | massInUnit) - (ticket.weightDiscounts | discounts)) | currency:'USD':'$':'1.3-3' }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right' *ngIf="totals.priceDiscounts.infested">{{ ticket.priceDiscounts.infested | currency:'USD':'$':'1.2-3' }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right' *ngIf="totals.priceDiscounts.musty">{{ ticket.priceDiscounts.musty | currency:'USD':'$':'1.2-3' }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right' *ngIf="totals.priceDiscounts.sour">{{ ticket.priceDiscounts.sour | currency:'USD':'$':'1.2-3' }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right' *ngIf="totals.priceDiscounts.weathered">{{ ticket.priceDiscounts.weathered | currency:'USD':'$':'1.2-3' }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right' *ngIf="totals.priceDiscounts.inspection">{{ ticket.priceDiscounts.inspection | currency:'USD':'$':'1.2-3' }}</td>
            <td [class.odd]='!even' [class.even]='even' class='right'>
                {{ (contract.price | pricePerUnit:'lbs':contract.quantity) * ((ticket.data.net | massInUnit) - (ticket.weightDiscounts | discounts)) - (ticket.priceDiscounts | discounts:ticket.priceDiscounts.infested:ticket.priceDiscounts.musty:ticket.priceDiscounts.sour:ticket.priceDiscounts.weathered:ticket.priceDiscounts.inspection) | currency:'USD':'$':'1.3-3' }}
            </td>
        </tr>
        <tr>
            <td class='total-row center'>TOTALS:</td>
            <td class='total-row right'></td>
            <td class='total-row right'>{{ totals.gross | number }}</td>
            <td class='total-row right'>{{ totals.tare | number }}</td>
            <td class='total-row right'>{{ totals.net | number }}</td>
            <td class='total-row right'></td>
            <td class='total-row right'>{{ totals.weightDiscounts.moisture | number:'1.0-2' }}</td>
            <td class='total-row right'></td>
            <td class='total-row right'>{{ totals.weightDiscounts.dryWeight | number:'1.0-2' }}</td>
            <td class='total-row right'></td>
            <td class='total-row right'>{{ totals.weightDiscounts.damagedGrain | number:'1.0-2' }}</td>
            <td class='total-row right'>{{ totals.adjustedWeight | number:'1.0-2' }} </td>
            <td class='total-row right'></td>
            <td class='total-row right' *ngIf="totals.priceDiscounts.infested || totals.priceDiscounts.musty || totals.priceDiscounts.sour || totals.priceDiscounts.weathered || totals.priceDiscounts.inspection">{{ totals.beforeFinalDiscounts | currency:'USD':'$':'1.3-3' }}</td>
            <td class='total-row right' *ngIf="totals.priceDiscounts.infested">{{ totals.priceDiscounts.infested | currency:'USD':'$':'1.2-3' }}</td>
            <td class='total-row right' *ngIf="totals.priceDiscounts.musty">{{ totals.priceDiscounts.musty | currency:'USD':'$':'1.2-3' }}</td>
            <td class='total-row right' *ngIf="totals.priceDiscounts.sour">{{ totals.priceDiscounts.sour | currency:'USD':'$':'1.2-3' }}</td>
            <td class='total-row right' *ngIf="totals.priceDiscounts.weathered">{{ totals.priceDiscounts.weathered | currency:'USD':'$':'1.2-3' }}</td>
            <td class='total-row right' *ngIf="totals.priceDiscounts.inspection">{{ totals.priceDiscounts.inspection | currency:'USD':'$':'1.2-3' }}</td>
            <td class='total-row right'>{{ totals.netToPay | currency:'USD':'$':'1.3-3' }}</td>
        </tr>
    </table>
</ng-container>